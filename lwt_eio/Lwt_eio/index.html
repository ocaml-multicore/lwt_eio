<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lwt_eio (lwt_eio.Lwt_eio)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">lwt_eio</a> &#x00BB; Lwt_eio</nav><header class="odoc-preamble"><h1>Module <code><span>Lwt_eio</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-Token" class="anchored"><a href="#module-Token" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Token/index.html">Token</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-with_event_loop" class="anchored"><a href="#val-with_event_loop" class="anchor"></a><code><span><span class="keyword">val</span> with_event_loop : <span>clock:<span class="xref-unresolved">Eio</span>.Time.clock <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><a href="Token/index.html#type-t">Token.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_event_loop ~clock fn</code> starts an Lwt event loop running and then executes <code>fn t</code>. When that finishes, the event loop is stopped.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Promise" class="anchored"><a href="#module-Promise" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Promise/index.html">Promise</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-run_eio" class="anchored"><a href="#val-run_eio" class="anchor"></a><code><span><span class="keyword">val</span> run_eio : <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>run_eio fn</code> allows running Eio code from within a Lwt function. It runs <code>fn ()</code> in a new Eio fiber and returns a promise for the result. If the returned promise is cancelled, it will cancel the Eio fiber. The new fiber is attached to the Lwt event loop's switch and will also be cancelled if the function passed to <a href="#val-with_event_loop"><code>with_event_loop</code></a> returns.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-run_lwt" class="anchored"><a href="#val-run_lwt" class="anchor"></a><code><span><span class="keyword">val</span> run_lwt : <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>run_lwt fn</code> allows running Lwt code from within an Eio function. It runs <code>fn ()</code> to create a Lwt promise and then awaits it. If the Eio fiber is cancelled, the Lwt promise is cancelled too.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-notify" class="anchored"><a href="#val-notify" class="anchor"></a><code><span><span class="keyword">val</span> notify : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>notify ()</code> causes <code>Lwt_engine.iter</code> to return, indicating that the event loop should run the hooks and resume yielded threads. Ideally, you should call this when an Eio fiber wakes up a Lwt thread, e.g. by resolving a Lwt promise. In most cases however this isn't really needed, since <code>Lwt_unix.yield</code> is deprecated and <code>Lwt.pause</code> will call this automatically.</p></div></div></div></body></html>